<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="/prodavnica.css">
    <title>Vasi Podatoci</title>
</head>
<body>
    <header>
        <div class="header-container">
            <div class="name">
                <p>Основи на WEB програмирање</p>
            </div>
            <div class="nav-element">
                <a href="./doma.html">ДОМА</a>
            </div>
            <div class="nav-element">
                <a href="./vasipodatoci.html">ВАШИ ПОДАТОЦИ</a>
            </div>
            <div class="nav-element">
                <a href="./prodavnica.html">ПРОДАВНИЦА</a>
            </div>
        </div>
    </header>
    <div class="content-container">
        <div class="input-container">
            <label>Product Name:</label>
            <input id="productName" type="text">
            <label>Quantity:</label>
            <input id="quantity" type="number">
            <label>Unit Price:</label>
            <input id="price" type="number">
            <br>
            <button onclick="addProduct()">Add Product</button>
        </div>
    </div>
        <table id="productTable">
            <thead>
                <tr>
                    <th>Product Name</th>
                    <th>Quantity</th>
                    <th>Price</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                
            </tbody>
            <tfoot>
                <tr>
                    <td colspan="2">Total:</td>
                    <td id="totalPrice">0</td>
                    <td></td>
                </tr>
            </tfoot>
        </table>
 
    <footer>
        <div class="footer-container">
            <div class="footer-flex">
                OWEB, Copyright &copy 2023
            </div>
        </div>
    </footer>
    <script>
        function addProduct(){
            var productName = document.getElementById("productName").value;
            var quantity = parseInt(document.getElementById("quantity").value,10);
            var price = parseFloat(document.getElementById("price").value);

            if(!productName || isNaN(quantity) || isNaN(price)){
                alert("Enter valid info in format: Name (string), quantity(integer), price(float)");
                return;
            }

            var productTable = document.getElementById("productTable");
            var tbody = productTable.getElementsByTagName('tbody')[0];
            var rows = tbody.getElementsByTagName('tr');
            for (var i = 0; i < rows.length; i++) {
                var rowProductName = rows[i].cells[0].textContent;
                if (rowProductName === productName) {
                    var currentQuantity = parseInt(rows[i].cells[1].textContent, 10);
                    var newQuantity = currentQuantity + quantity;
                    rows[i].cells[1].textContent = newQuantity;

                    var currentPrice = parseFloat(rows[i].cells[2].textContent);
                    var newPrice = currentPrice + (price * quantity);
                    rows[i].cells[2].textContent = newPrice.toFixed(2);
                    updateTotalPrice();
                    return;
                }
            }
            var newRow = tbody.insertRow();
            newRow.insertCell(0).textContent = productName;
            newRow.insertCell(1).textContent = quantity;
            newRow.insertCell(2).textContent = (price * quantity).toFixed(2);


            var deleteCell = newRow.insertCell(3);
            var deleteButton = document.createElement('span');
            deleteButton.innerHTML = '&times;';
            deleteButton.className = 'delete-btn';
            deleteButton.onclick = function() {
                tbody.removeChild(newRow);
                updateTotalPrice();
            };
            deleteCell.appendChild(deleteButton);

            updateTotalPrice();
        }


        function updateTotalPrice() {
            var table = document.getElementById('productTable');
            var tbody = productTable.getElementsByTagName('tbody')[0];
            var rows = tbody.getElementsByTagName('tr');

            var totalPrice = 0;

            for (var i = 0; i < rows.length; i++) {
                totalPrice += parseFloat(rows[i].cells[2].textContent);
            }

            document.getElementById('totalPrice').textContent = totalPrice.toFixed(2);
        }

        


    </script>
</body>
</html>